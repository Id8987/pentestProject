import { useReducer, useState } from "react"
import { useNavigate } from "react-router-dom"
import { AuthData } from "../auth/AuthWrapper"

export  const Login = () =>{

    //import de la fonction login 
    const {login} = AuthData()

    const navigate = useNavigate()
    const [errorMes, setErrorMess] = useState("")

    //fonction qui gere la connexion
    const doLogin = async () =>{
        
        try{
            await login(formData.userEmail, formData.password);
            navigate("/");
        }catch(error)
        {   
            
           setErrorMess(error)
           console.log(errorMes)
        }
        
    }
    const [formData, setFormData] = useReducer((formData, newItem) =>{return ({...formData, ...newItem})},{userEmail:"", password:""})

    return(
        <div className="page">
            <h2>Login Page</h2>
            <div className="inputs">

                <div className="input">
                    <input id="userEmail" type="text" value={formData.userEmail} onChange={(e) => setFormData({userEmail:e.target.value})} placeholder="e.g. abc@gmail.com" />
                </div>
                
                <div className="input">
                    <input id="password" type="password" value={formData.password} onChange={(e) => setFormData({password:e.target.value})} placeholder=" your password " />
                </div>
                <div className="button">
                    <button onClick={doLogin}>Log Ine</button>
                </div>
                <div className="error">{errorMes}</div>
            </div>
        </div>
    )
}