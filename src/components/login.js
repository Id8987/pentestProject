import { useEffect, useReducer, useState } from "react"
import { Link, useNavigate } from "react-router-dom"
import { AuthData } from "../auth/AuthWrapper"

export  const Login = () =>{
    const [userData, setUserData] = useState("")

    

    //import de la fonction login 
    const {login} = AuthData()

    const navigate = useNavigate()
    const [errorMes, setErrorMess] = useState("")

    //fonction qui gere la connexion
    const doLogin = async () =>{
        
        try{
            await login(formData.userEmail, formData.password);
            navigate("/pentest");
        }catch(error)
        {   
            
           setErrorMess(error)
           console.log(errorMes)
        }
        
    }
    const [formData, setFormData] = useReducer((formData, newItem) =>{return ({...formData, ...newItem})},{userEmail:"", password:""})
    
    return(
        <div className="page" style={{'marginTop':150}}>

           
            
            <div className="inputs">

                <div className="input">
                    <h3 className="input-title">Email</h3>
                    <input id="userEmail" type="text" value={formData.userEmail} onChange={(e) => setFormData({userEmail:e.target.value})} placeholder="e.g. abc@gmail.com" />
                </div>
                
                <div className="input">
                    <h3 className="input-title">Password</h3>
                    <input id="password" type="password" value={formData.password} onChange={(e) => setFormData({password:e.target.value})} placeholder=" your password " />
                </div>
                <div className="button">
                    <button onClick={doLogin}>SE CONNECTER</button>
                </div>
                {errorMes &&
                <div className="error">  <p>{errorMes}</p></div>
                }
                <div>
                    <p>Vous n'avez pas de compte? <Link to="/inscription" element={<h1>hello</h1>}>S'INSCRIRE</Link> </p>
                </div>
            </div>
            
        </div>
    )
}
const linkStyle = {
    textDecoration:'none',
    color:'#fff'
}