import { createContext, useContext, useState } from "react";
import Navbar from "../components/Navbar";
import { RenderRoutes } from "../components/RenderNavigation";



const AuthContext = createContext()
export const AuthData = () => useContext(AuthContext)

export const AuthWrapper = () =>{
    const otherUserData = {
        firstName:"Issakha",
        lastName:"Diouf",
        country:"SEN",
        entreprise:"SONATEL"
    }

    const [user, setUser] = useState({ ...otherUserData, email:"", isAuthenticate: false})
   

    // gerer l'insciption de l'utilisateur
    const login = (userEmail, password) => {
        return new Promise((resolve, reject) => {

            //ici on compare avec les valuers de la base de donnees

            if( userEmail === "issakha" & password === "password"){
                setUser({...otherUserData,email:userEmail, isAuthenticate:true})
                resolve("success")
            }
            else{
                reject("incorrect password or email ")
            }
        })
    }

    // fonction qui gere la deconnection

    const logout = () =>{
        setUser({...otherUserData,email:"", isAuthenticate:false})
    }

    return(
        <AuthContext.Provider value={{user, login, logout}}>
            <Navbar />
            <RenderRoutes />
        </AuthContext.Provider>
    )
}